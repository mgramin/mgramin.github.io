<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Database as Code. Not only migrations | ProGramin'g thoughts</title><link rel=canonical href=https://gramin.pro/posts/database-as-code/><meta name=description content="  My name is Maksim Gramin. I’m a software developer passionate about Databases and SQL.
  
  If you find any mistake, inaccuracy, or anything else, feel free to text me or [create a PR](https://github.com/mgramin/mgramin.github.io)."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Database as Code. Not only migrations"><meta property="og:description" content="I have spent a lot of time working with various database systems. I was a SQL and PL/SQL developer on big distributed teams, writing tons of nontrivial SQL queries and implementing tons of complex and tricky business logic on the database side. And I worked as a &ldquo;classical&rdquo; Java developer where we interacted with any databases through ORM, operating mostly JPA annotation and framework properties (hoping to find and turn on a &ldquo;magic&rdquo; parameter fast=true)."><meta property="og:type" content="article"><meta property="og:url" content="https://gramin.pro/posts/database-as-code/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-27T14:40:01+03:00"><meta property="article:modified_time" content="2022-02-27T14:40:01+03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Database as Code. Not only migrations"><meta name=twitter:description content="I have spent a lot of time working with various database systems. I was a SQL and PL/SQL developer on big distributed teams, writing tons of nontrivial SQL queries and implementing tons of complex and tricky business logic on the database side. And I worked as a &ldquo;classical&rdquo; Java developer where we interacted with any databases through ORM, operating mostly JPA annotation and framework properties (hoping to find and turn on a &ldquo;magic&rdquo; parameter fast=true)."><link rel=stylesheet href=https://gramin.pro/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://gramin.pro/images/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-SZPJMEZSBE"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SZPJMEZSBE",{anonymize_ip:!1})}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://gramin.pro/posts/rivers-and-axis/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://gramin.pro/posts/percona-community/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&text=Database%20as%20Code.%20Not%20only%20migrations" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&title=Database%20as%20Code.%20Not%20only%20migrations" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&is_video=false&description=Database%20as%20Code.%20Not%20only%20migrations" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Database%20as%20Code.%20Not%20only%20migrations&body=Check out this article: https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&title=Database%20as%20Code.%20Not%20only%20migrations" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&title=Database%20as%20Code.%20Not%20only%20migrations" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&name=Database%20as%20Code.%20Not%20only%20migrations&description=I%20have%20spent%20a%20lot%20of%20time%20working%20with%20various%20database%20systems.%20I%20was%20a%20SQL%20and%20PL%2fSQL%20developer%20on%20big%20distributed%20teams%2c%20writing%20tons%20of%20nontrivial%20SQL%20queries%20and%20implementing%20tons%20of%20complex%20and%20tricky%20business%20logic%20on%20the%20database%20side.%20And%20I%20worked%20as%20a%20%26ldquo%3bclassical%26rdquo%3b%20Java%20developer%20where%20we%20interacted%20with%20any%20databases%20through%20ORM%2c%20operating%20mostly%20JPA%20annotation%20and%20framework%20properties%20%28hoping%20to%20find%20and%20turn%20on%20a%20%26ldquo%3bmagic%26rdquo%3b%20parameter%20fast%3dtrue%29." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&t=Database%20as%20Code.%20Not%20only%20migrations" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Database as Code. Not only migrations</h1><div class=meta><div class=postdate><time datetime="2022-02-27 14:40:01 +0300 +0300" itemprop=datePublished>2022-02-27</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/sql rel=tag>SQL</a>
,
<a class=tag-link href=/tags/database-as-code rel=tag>database-as-code</a></div></div></header><div class=content itemprop=articleBody><p>I have spent a lot of time working with various database systems. I was a SQL and PL/SQL developer on big distributed teams, writing tons of nontrivial SQL queries and implementing tons of complex and tricky business logic on the database side. And I worked as a &ldquo;classical&rdquo; Java developer where we interacted with any databases through ORM, operating mostly JPA annotation and framework properties (hoping to find and turn on a &ldquo;magic&rdquo; parameter <code>fast=true</code>).</p><p>And all this time, I have had this feeling that database technologies (especially the part that is related to the comfort and speed of development) are far behind other IT areas (e.g. WEB, infrastructure, integrations, etc.). Working with databases remained slow, laborious, and very risky.</p><p>And I&rsquo;m not alone in this feeling. For example, the tagline of <a href=https://www.dolthub.com>dolt</a> database (which provides Git options and MySQL API for your Data) also says about it:</p><blockquote><p>&ldquo;Software development has come a long way in the last 30 years.
Why is your database stuck in 1995?&rdquo;</p></blockquote><p><a href=https://twitter.com/markuswinand>Markus Winand</a> in his talk &ldquo;<a href=https://www.slideshare.net/MarkusWinand/modern-sql>Modern SQL in Open Source and Commercial Databases</a>&rdquo; discusses the situation where most developers still use SQL-92 standard to this day:</p><blockquote><p>&ldquo;Still Using Windows 3.1? So why stick to SQL-92?&rdquo;</p></blockquote><p>And now the most interesting. <a href=https://twitter.com/tastapod>Dan North</a> in his eponymous <a href=https://speakerdeck.com/tastapod/arent-we-forgetting-someone>talk</a> about DevOps things wonders:</p><blockquote><p>&ldquo;Aren&rsquo;t we forgetting someone?&rdquo;</p></blockquote><p>And the right answer is: &ldquo;Yes, we are forgetting about DBA&rsquo;s&rdquo;. Because DBA&rsquo;s are often separate geographically and organizationally, and databases don&rsquo;t fit into the DevOps story.</p><p>So let&rsquo;s take a look closer. The DevOps era brought to us &ldquo;Everything as Code&rdquo; philosophy, where any IT area might represent as a plain code, and we can work with it using standard tools and technologies (code editors, control version systems, CI/CD pipelines etc.). And yes, indeed, there are many &ldquo;Everything as Code&rdquo; realizations for many areas, for example:</p><ul><li>Pipeline as Code (<code>Jenkinsfile</code>, <code>.gitlab-ci.yml</code>, <code>settings.kts</code> in TeamCity)</li><li>Infrastructure as Code (Kubernetes, Terraform, Ansible)</li><li>Diagram as Сode (PlantUML, Graphviz, Mermaid)</li><li>Documentation as Сode (Markdown, AsciiDoc)</li><li>Tests as Code (Gatling, Cucumber)</li></ul><p>But how about &ldquo;Database as Code&rdquo;? It was still a very exotic combination of words, and Dan North offers four simple rules for treating a database like Code:</p><ul><li>All changes scripted and automated</li><li>All changes under version control</li><li>Ability to release on demand</li><li>DBA&rsquo;s integrated with Dev and Ops</li></ul><p>It&rsquo;s been six years, and nowadays, it&rsquo;s hard to find a project that doesn&rsquo;t follow these rules (at least the first three). There are a lot of <a href=https://github.com/mgramin/awesome-db-tools#migration-tools>database migration tools</a> and ways to integrate it with your VCS and your CI/CD pipeline. And it&rsquo;s really great.</p><p>However, I&rsquo;ve always been excited about a few things:</p><ul><li>Database code is not only &ldquo;scripts with changes&rdquo;. It&rsquo;s also DML and all kinds of SQL scripts</li><li>In addition to DBA&rsquo;s, there are many kinds of data people who intensively work with databases and use SQL</li><li>Is SQL still the main database language?</li></ul><p>And I prepared an extended list of &ldquo;Database as Code&rdquo; rules:</p><ul><li>Treat your database or other storage system as a code</li><li>All changes and operations with the database and all queries (ideally) against the database should be expressed as a plain old code</li><li>Git (or anything else VCS) is a single source of truth for database code</li><li>SQL actually is a main database language supported by almost all DBMS</li><li>SQL is not a bytecode for your data and your database, it&rsquo;s a normal human-oriented program language (<a href=/posts/sql-is-not-a-bytecode-for-data>why</a>)</li><li>SQL is designed not only for data, but also for metadata</li><li>Database code is not only DDL and other migration scripts, DML and all kinds of SQL scripts too</li><li>Database code is a normal code, and it also needs static analysis, code review (especially by DBA, analysts and business people), tests and automation of it all</li><li>DBA&rsquo;s and data people should be integrated with Dev and Ops</li><li>Ability to release on demand.</li></ul><p>The original version of this list (as well as a list of related tools and resources) is hosted on <a href=https://github.com/mgramin/database-as-code>GitHub</a>. Feel free to create a PR and issues.</p></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="gramin-pro",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&text=Database%20as%20Code.%20Not%20only%20migrations" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&title=Database%20as%20Code.%20Not%20only%20migrations" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&is_video=false&description=Database%20as%20Code.%20Not%20only%20migrations" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Database%20as%20Code.%20Not%20only%20migrations&body=Check out this article: https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&title=Database%20as%20Code.%20Not%20only%20migrations" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&title=Database%20as%20Code.%20Not%20only%20migrations" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&name=Database%20as%20Code.%20Not%20only%20migrations&description=I%20have%20spent%20a%20lot%20of%20time%20working%20with%20various%20database%20systems.%20I%20was%20a%20SQL%20and%20PL%2fSQL%20developer%20on%20big%20distributed%20teams%2c%20writing%20tons%20of%20nontrivial%20SQL%20queries%20and%20implementing%20tons%20of%20complex%20and%20tricky%20business%20logic%20on%20the%20database%20side.%20And%20I%20worked%20as%20a%20%26ldquo%3bclassical%26rdquo%3b%20Java%20developer%20where%20we%20interacted%20with%20any%20databases%20through%20ORM%2c%20operating%20mostly%20JPA%20annotation%20and%20framework%20properties%20%28hoping%20to%20find%20and%20turn%20on%20a%20%26ldquo%3bmagic%26rdquo%3b%20parameter%20fast%3dtrue%29." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgramin.pro%2fposts%2fdatabase-as-code%2f&t=Database%20as%20Code.%20Not%20only%20migrations" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2022 Maksim Gramin</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script></html>